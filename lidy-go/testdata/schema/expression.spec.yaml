name: expression
box: make lidy parser
content:
  - name: check for in.checker
    content:
      - name: valid forms
        input:
          outcome: accept
        matrix:
          expression:
            - '_in: []'
            - '_in: [aaa, 22, "22"]'
            - '_in: [aaa, bbb]'
            - '_in: [aaa]'
            - '_in: [false, null, zz, 0.1]'
            - '_in: [true, bbb]'
      - name: invalid forms
        input:
          outcome: reject
          contain: '_in'
        matrix:
          expression:
            - '_in: .2'
            - '_in: 22'
            - '_in: [[]]'
            - '_in: [{ _map: {} }]'
            - '_in: [{}]'
            - '_in: aa'
            - '_in: null'
            - '_in: true'
            - '_in: {}'
  - name: check for listChecker
    content:
      - name: valid forms
        input:
          outcome: accept
        matrix:
          expression:
            - '_list: []'
            - |-
              _list: []
              _listFacultative: []
            - |-
              _list: []
              _listFacultative: []
              _listOf: int
            - |-
              _list: []
              _listFacultative: []
              _listOf: int
              _min: 1
              _max: 2
            - |-
              _list: []
              _listFacultative: []
              _listOf: int
              _nb: 2
            - |-
              _list: []
              _listOf: int
            - '_listOf: int'
      - name: invalid form
        input:
          outcome: reject
        matrix:
          expression:
            - '_list: word'
            - '_listOf: []'
            - 'list: string'
            - 'listOf: string'
  - name: check for mapChecker
    content:
      - name: valid form
        input:
          outcome: accept
        matrix:
          expression:
            - '_map: {}'
            - |-
              _map: {}
              _mapFacultative: {}
            - |-
              _map: {}
              _mapFacultative: {}
              _mapOf: { string: string }
            - |-
              _map: {}
              _mapFacultative: {}
              _mapOf: { string: string }
              _min: 1
              _max: 2
            - |-
              _map: {}
              _mapFacultative: {}
              _mapOf: { string: string }
              _nb: 2
            - |-
              _map: {}
              _mapOf: { string: string }
            - '_mapFacultative: {}'
            - '_mapOf: { string: string }'
      - name: invalid form
        input:
          outcome: reject
        matrix:
          expression:
            - '_map: 1'
            - '_map: 1.1'
            - '_map: []'
            - '_map: false'
            - '_map: null'
            - '_map: string'
            - '_map: true'
            - '_mapOf: []'
            - '_mapOf: [string]'
            - '_mapOf: string'
            - 'map: {}'
  - name: check for min.checker, max.checker and nb.checker
    content:
      - name: valid forms
        input:
          outcome: accept
        matrix:
          expression:
            - |-
              _map: {}
              _max: 2
            - |-
              _map: {}
              _min: 2
            - |-
              _map: {}
              _nb: 2
      - name: invalid forms
        input:
          outcome: reject
        content:
          - input:
              contain: _max
            matrix:
              expression:
                - |-
                  _map: {}
                  _max: []
                - |-
                  _map: {}
                  _max: bc
                - |-
                  _map: {}
                  _max: {}
          - input:
              contain: _min
            matrix:
              expression:
                - |-
                  _map: {}
                  _min: []
                - |-
                  _map: {}
                  _min: aa
                - |-
                  _map: {}
                  _min: {}
          - input:
              contain: _nb
            matrix:
              expression:
                - |-
                  _map: {}
                  _nb: []
                - |-
                  _map: {}
                  _nb: z_
                - |-
                  _map: {}
                  _nb: {}
  - name: check for oneOf.checker
    content:
      - name: valid forms
        input:
          outcome: accept
        matrix:
          expression:
            - '_oneOf: []'
            - '_oneOf: [string, int, { _map: {} }]'
            - '_oneOf: [string]'
      - name: invalid forms
        input:
          outcome: reject
          contain: _oneOf
        matrix:
          expression:
            - '_oneOf: .2'
            - '_oneOf: 22'
            - '_oneOf: aa'
            - '_oneOf: null'
            - '_oneOf: true'
            - '_oneOf: {}'
  - name: check that checkers are used with the right signature
    input:
      outcome: reject
    matrix:
      expression:
        - '_map: 1'
        - '_map: 1.1'
        - '_map: []'
        - '_map: false'
        - '_map: null'
        - '_map: string'
        - '_map: true'
        - '_map: word'
  - name: distinguish known and unknown identifiers
    content:
      - name: accept if know
        input:
          outcome: accept
        matrix:
          expression:
            - any
            - boolean
            - float
            - int
            - nullType
            - string
            - timestamp
      - name: reject if (rule is) unknown
        input:
          outcome: reject
        content:
        - input:
            expression: foo
            contain: foo
        - input:
            expression: bar
            contain: bar
