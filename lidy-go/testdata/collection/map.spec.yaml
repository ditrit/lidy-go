name: _map 
content:

  - name: _map 0 entry
    input:
      expression: '_map: {}'
    content:
      - box: trial ACCEPT
        name: accept the empty dict
        input:
          data: '{}'
      - box: trial REJECT
        content:
          - name: any unknown entry
            content:
              - input:
                  data: '{ a: va }'
              - input:
                  data: '{ b: 4 }'
          - name: nodes that are not dictionaries
            input:
              data: '[]'

  - name: _map 1 entry
    input:
      expression: '_map: { aa: float }'
    content:
      - box: trial ACCEPT
        name: if valid
        content:
          - input:
              data: '{ aa: 0 }'
          - input:
              data: '{ aa: 2.2 }'
      - box: trial REJECT
        content:
          - name: any unknown entry
            content:
            - input:
                data: '{ a: va }'
            - input:
                data: '{ b: 4 }'
          - name: missing entry
            input:
              data: '{}'
          - name: nodes that are not dictionaries
            matrix:
              data: ['0.1', '[]', 'null']
            input: {}

  - name: _map 0 _mapFacultative 2 entries
    input:
      expression: '_mapFacultative: { a: string, b: int }'
    content:
      - box: trial ACCEPT
        content:
          - name: the empty dict
            input:
              data: '{}'
          - name: when all entries are present and valid
            input:
              data:  '{ a: va, b: 4 }'
          - name: when only some entries are present
            content:
              - input:
                  data: '{ a: va }'
              - input:
                  data: '{ b: 4 }'

      - box: trial REJECT
        content:
          - name: extraneous unknown entries
            input:
              data: '{ a: va, b: 4, z: 12 }'
          - name: if an entry does not match
            input:
              data: '{ a: 12 }'
          - name: nodes that are not dictionaries
            matrix:
              data: ['0', '[]', a, 'true']
            input: {}
          - name: single unknown entries
            input:
              data: '{ z: 12 }'

  - flag: PENDING
    name: _map 1 entry whose property is a lidy keyword
    matrix:
      keywordValue:
        - _map
        - _mapOf
        - _list
        - _listOf
    input:
      expression: '_map: { "${keyword}": int }'
    content:
      - name: dict with a matching entry
        box: template trial ACCEPT
        input:
          data: '{ ${keyword}: 2 }'
      - name: rejection
        box: template trial REJECT
        content:
        - name: dict with a non-matching key
          content:
            - input:
                data: '{ a: 3 }'
            - input:
                data: '{ _b: 4 }'
        - name: dict with a non-matching value
          matrix:
            data:
              - '{ ${keyword}: 1.1 }'
              - '{ ${keyword}: a }'
              - '{ ${keyword}: null }'
              - '{ ${keyword}: true }'
              - '{ ${keyword}: {} }'
          input: {}
        - name: the entry is missing
          input:
            data: '{}'
        - name: there are unknown entries
          content:
            - input:
                data: '{ ${keyword}: 2, a: 4 }'
            - input:
                data: '{ ${keyword}: 2, b: va }'
        - name: nodes that are not dictionaries
          input:
            data: '[]'
        - name: unrelated maps
          content:
            - input:
                data: '{ a: 4 }'
            - input:
                data: '{ b: va }'
